#+TITLE:  _=matplotlib=_ : librairie pour la représentation graphique
#+AUTHOR: Xavier Garrido
#+DATE:   25/02/2017
#+OPTIONS: toc:nil ^:{} author:nil H:2
#+STARTUP:     beamer
#+LATEX_CLASS: python-slide

* Librarie =matplotlib=
** Sommaire
:PROPERTIES:
:BEAMER_ENV: fullframe
:END:
#+TOC: headlines
** =matplotlib= ?

#+ATTR_BEAMER: :overlay +-
- La librairie =matplotlib= est *la* bibliothèque graphique de Python

- Étroitement liée à =numpy= et =scipy=

- Grande variété de *format de sortie (=png=, =pdf=, =svg=, =eps=, =pgf=)*
  ainsi que support de *\LaTeX* pour le texte

- /Graphical User Interface/ pour l'exploration interactive des figures (zoom,
  sélection,...)

- Tous les aspects d'une figure (taille, position,...) peuvent être contrôlés
  d'un point de vue /programmatique/ \to *reproductibilité* des figures et des
  résultats scientifiques
** Installation & importation de =matplotlib=

#+ATTR_BEAMER: :overlay +-
- Installation /via/ =pip=
  #+BEGIN_SRC shell-session
    @\prompt@ pip install matplotlib
  #+END_SRC

- Convention d'importation
  #+BEGIN_SRC python
    In [1]: import matplotlib as mpl
    In [2]: import matplotlib.pyplot as plt

    In [3]: mpl.__version__
    Out[3]: '3.3.3'
  #+END_SRC

** Première figure sous =matplotlib=
#+BEAMER: \setbeamercovered{invisible}

*** Python code
:PROPERTIES:
:BEAMER_COL: 0.52
:END:
#+BEGIN_SRC python
  In [1]: %matplotlib
  In [2]: import matplotlib.pyplot as plt
  In [3]: import numpy as np

  In [4]: x = np.linspace(0, 3*np.pi, 100)

  In [5]: plt.plot(x, np.sin(x))
  In [6]: plt.plot(x, np.cos(x))
#+END_SRC

#+BEAMER: \pause
#+BEGIN_SRC latex
  \begin{tikzpicture}[remember picture,overlay]
    \tikzset{codeblock/.style={color=#1!50,rounded corners=0.5ex, opacity=0.2, fill}}
    \begin{scope}[yshift=-0.55cm]
    \draw[codeblock=blue] (6.5ex,22.5ex) rectangle (16ex,25ex);
    \node[blue] (t) [xshift=55ex, yshift=+28ex] {\small Utiliser \texttt{\bf \%matplotlib inline} dans un notebook};
    \draw[->, blue] (t.west) to [out=180, in=0] (17ex, 23.5ex);
    \end{scope}
  \end{tikzpicture}
#+END_SRC

#+BEAMER: \pause
- Sauvegarder la figure (=eps=, =pdf=, =png=)

#+BEGIN_SRC python
  In [7]: plt.savefig("/tmp/mpl1.pdf")
#+END_SRC

*** Figure
:PROPERTIES:
:BEAMER_COL: 0.5
:END:

#+ATTR_LATEX: :width 1.1\linewidth
[[file:figures/mpl.pdf]]

** COMMENT Comment afficher vos figures : =show()= or not =show()=

#+BEAMER: \setbeamercovered{invisible}

- Affichage depuis un script python
  #+BEGIN_SRC python -n
    import matplotlib.pyplot as plt
    import numpy as np

    x = np.linspace(0, 3*np.pi, 100)

    plt.plot(x, np.sin(x))
    plt.plot(x, np.cos(x))

    plt.show()
  #+END_SRC

  #+BEGIN_SRC latex
    \begin{tikzpicture}[remember picture,overlay]
      \tikzset{codeblock/.style={color=#1!50,rounded corners=0.5ex, opacity=0.2, fill}}
      \draw[codeblock=blue] (0ex,4.5ex) rectangle (9ex,7ex);
      \node[blue] (t) [xshift=40ex, yshift=+10ex] {\small Utilisation de \texttt{\bf plt.show()}};
      \draw[->, blue] (t.west) to [out=180, in=0] (10ex, 5.5ex);
    \end{tikzpicture}
  #+END_SRC

** COMMENT Comment afficher vos figures : =show()= or not =show()=

#+BEAMER: \setbeamercovered{invisible}

- Affichage depuis la console =ipython=
  #+BEGIN_SRC python
    In [1]: %matplotlib
    Using matplotlib backend: TkAgg

    In [2]: import matplotlib.pyplot as plt
    In [3]: import numpy as np

    In [4]: x = np.linspace(0, 3*np.pi, 100)

    In [6]: plt.plot(x, np.sin(x))
    In [7]: plt.plot(x, np.cos(x))
  #+END_SRC

  #+BEGIN_SRC latex
    \begin{tikzpicture}[remember picture,overlay]
      \tikzset{codeblock/.style={color=#1!50,rounded corners=0.5ex, opacity=0.2, fill}}
      \draw[codeblock=blue] (6.5ex,22.5ex) rectangle (17ex,25ex);
      \node[blue] (t) [xshift=50ex, yshift=+21ex] {\small Utilisation de \texttt{\bf \%matplotlib}};
      \draw[->, blue] (t.west) to [out=180, in=0] (18ex, 23.5ex);
    \end{tikzpicture}
  #+END_SRC

- Possibilité également de lancer la commande =ipython= avec l'option =--matplotlib=

* /Kozmetix/ sous =matplotlib=
** Titre
:PROPERTIES:
:BEAMER_ENV: fullframe
:END:

#+BEGIN_EXPORT beamer
\title{\emph{Kozmetix} sous \texttt{matplotlib}}
\titlepage
\thispagestyle{empty}
#+END_EXPORT

** /Kozmetix/ sous =matplotlib=
#+BEAMER: \framesubtitle{Lignes, marqueurs : styles \& couleurs}
*** Python code
:PROPERTIES:
:BEAMER_COL: 0.52
:END:

#+BEAMER: \small

#+ATTR_LATEX: :options fontsize=\scriptsize
#+BEGIN_SRC python
  In [8]: plt.plot(x, x + 0, linestyle="solid")

  In [9]: plt.plot(x, x + 1, linestyle="dashed")

  In[10]: plt.plot(x, x + 2, linestyle="dashdot")

  In[11]: plt.plot(x, x + 3, linestyle="dotted")
#+END_SRC

- Il est également possible d'utiliser les notations raccourcies

  | =-=  | \equiv | =solid=   |
  | =--= | \equiv | =dashed=  |
  | =-.= | \equiv | =dashdot= |
  | =:=  | \equiv | =dotted=  |

*** Figure
:PROPERTIES:
:BEAMER_COL: 0.5
:END:

#+ATTR_LATEX: :width 1.1\linewidth
[[file:figures/mpl_line3.pdf]]

** /Kozmetix/ sous =matplotlib=
#+BEAMER: \framesubtitle{Lignes, marqueurs : styles \& couleurs}

#+BEAMER: \vskip-20pt

*** Python code
:PROPERTIES:
:BEAMER_COL: 0.52
:END:

#+BEAMER: \footnotesize

- En spécifiant le nom de la couleur
  #+ATTR_LATEX: :options fontsize=\scriptsize
  #+BEGIN_SRC python
    In [8]: plt.plot(x, np.sin(x - 0), color="blue")
  #+END_SRC
- Nom raccourci (=rgbcmyk=)
  #+ATTR_LATEX: :options fontsize=\scriptsize
  #+BEGIN_SRC python
    In [9]: plt.plot(x, np.sin(x - 1), color="g")
  #+END_SRC
- Échelle de gris =[0; 1]=
  #+ATTR_LATEX: :options fontsize=\scriptsize
  #+BEGIN_SRC python
    In[10]: plt.plot(x, np.sin(x - 2), color="0.75")
  #+END_SRC
- Code héxadécimal (=RRGGBB=)
  #+ATTR_LATEX: :options fontsize=\scriptsize
  #+BEGIN_SRC python
    In[11]: plt.plot(x, np.sin(x - 3),
                     color="#FFDD44")
  #+END_SRC
- RGB /tuple/ =[0; 1]=
  #+ATTR_LATEX: :options fontsize=\scriptsize
  #+BEGIN_SRC python
    In[12]: plt.plot(x, np.sin(x - 4),
                     color=(1.0,0.2,0.3))
  #+END_SRC
- Couleur du cycle =C0-9=
  #+ATTR_LATEX: :options fontsize=\scriptsize
  #+BEGIN_SRC python
    In[13]: plt.plot(x, np.sin(x - 5), color="C4")
  #+END_SRC

*** Figure
:PROPERTIES:
:BEAMER_COL: 0.5
:END:

#+ATTR_LATEX: :width 1.1\linewidth
[[file:figures/mpl_color4.pdf]]

** /Kozmetix/ sous =matplotlib=
#+BEAMER: \framesubtitle{Lignes, marqueurs : styles \& couleurs}
*** Python code
:PROPERTIES:
:BEAMER_COL: 0.52
:END:

#+BEAMER: \small\vskip+17pt
#+BEGIN_SRC python
  In [4]: x = np.linspace(0, 3*np.pi, 30)
  In [5]: plt.plot(x, np.sin(x), "o")
#+END_SRC

#+BEAMER: \pause\vskip-18pt
#+BEGIN_SRC python
  In [6]: plt.plot(x, np.sin(x), "p",
     ...:          markersize=15,
     ...:          markerfacecolor="pink",
     ...:          markeredgecolor="gray",
     ...:          markeredgewidth=2)
#+END_SRC

*** Figure
:PROPERTIES:
:BEAMER_COL: 0.5
:END:

#+BEGIN_SRC latex
  \begin{center}
    \includegraphics<1>[width=1.1\linewidth]{figures/mpl_marker0.pdf}
    \includegraphics<2>[width=1.1\linewidth]{figures/mpl_marker1.pdf}
  \end{center}
#+END_SRC
** /Kozmetix/ sous =matplotlib=
#+BEAMER: \framesubtitle{Lignes, marqueurs : styles \& couleurs}

#+BEGIN_SRC latex
  \begin{center}
    \includegraphics[width=0.6\linewidth]{figures/mpl_marker2.pdf}
  \end{center}
#+END_SRC

#+BEGIN_SRC python
  In [7]: for marker in ["o", ".", ",", "x", "+", "v", "^", "<", ">", "s", "d"]:
    ...:     plt.plot(np.random.rand(10), np.random.rand(10), marker)
#+END_SRC

** /Kozmetix/ sous =matplotlib=
#+BEAMER: \framesubtitle{Lignes, marqueurs : styles \& couleurs}
*** Python code
:PROPERTIES:
:BEAMER_COL: 0.52
:END:

#+BEAMER: \small
- Il est finalement possible de combiner style & couleur au sein d'une syntaxe
  minimaliste

  #+BEGIN_SRC python
    In [8]: plt.plot(x, x + 0, "-og")

    In [9]: plt.plot(x, x + 1, "--xc")

    In[10]: plt.plot(x, x + 2, "-..k")

    In[11]: plt.plot(x, x + 3, ":sr")
  #+END_SRC

- Pour découvrir l'ensemble des options d'affichage *=plt.plot?=* ou
  *=help(plt.plot)=*

*** Figure
:PROPERTIES:
:BEAMER_COL: 0.5
:END:

#+ATTR_LATEX: :width 1.1\linewidth
[[file:figures/mpl_colorline3.pdf]]


** /Kozmetix/ sous =matplotlib=
#+BEAMER: \framesubtitle{Axes : échelle, limites \& \emph{ticks}}

*** Figure
:PROPERTIES:
:BEAMER_COL: 0.5
:END:

#+BEGIN_SRC latex
  \begin{center}
    \includegraphics<1>[width=1.1\linewidth]{figures/mpl_scale0.pdf}
    \includegraphics<2->[width=1.1\linewidth]{figures/mpl_scale1.pdf}
  \end{center}
#+END_SRC

*** Python code
:PROPERTIES:
:BEAMER_COL: 0.52
:END:

#+BEAMER: \small\vskip+17pt
#+BEGIN_SRC python
  In [4]: x = np.linspace(0, 3*np.pi, 100)
  In [5]: plt.plot(x, np.sin(x))
#+END_SRC

#+BEAMER: \pause\vskip-18pt
#+BEGIN_SRC python
  In [6]: plt.xscale("log")
  In [7]: plt.yscale("log")
#+END_SRC

#+BEAMER: \pause\vskip-18pt
#+BEGIN_SRC python
  In [8]: plt.loglog(x, np.sin(x))
#+END_SRC

- Pour découvrir l'ensemble des options d'affichage *=plt.xscale?=* ou
  *=help(plt.xscale)=*

** /Kozmetix/ sous =matplotlib=
#+BEAMER: \framesubtitle{Axes : échelle, limites \& \emph{ticks}}

*** Figure
:PROPERTIES:
:BEAMER_COL: 0.5
:END:

#+BEGIN_SRC latex
  \begin{center}
    \includegraphics<1>[width=1.1\linewidth]{figures/mpl_limit0.pdf}
    \includegraphics<2>[width=1.1\linewidth]{figures/mpl_limit1.pdf}
    \includegraphics<3>[width=1.1\linewidth]{figures/mpl_limit2.pdf}
    \includegraphics<4>[width=1.1\linewidth]{figures/mpl_limit3.pdf}
  \end{center}
#+END_SRC

*** Python code
:PROPERTIES:
:BEAMER_COL: 0.52
:END:

#+BEAMER: \small\vskip+17pt
#+BEGIN_SRC python
  In [4]: x = np.linspace(0, 3*np.pi, 100)
  In [5]: plt.plot(x, np.sin(x))

  In [6]: plt.xlim(-1, 11)
  In [7]: plt.ylim(-1.5, 1.5)
#+END_SRC

#+BEAMER: \pause\vskip-18pt
#+BEGIN_SRC python
  In [8]: plt.axis([11, -1, 1.5, -1.5])
#+END_SRC

#+BEAMER: \pause\vskip-18pt
#+BEGIN_SRC python
  In [9]: plt.axis("tight")
#+END_SRC

#+BEAMER: \pause\vskip-18pt
#+BEGIN_SRC python
  In[10]: plt.axis("equal")
#+END_SRC

- Pour découvrir l'ensemble des options d'affichage *=plt.axis?=* ou
  *=help(plt.axis)=*

** /Kozmetix/ sous =matplotlib=
#+BEAMER: \framesubtitle{Axes : échelle, limites \& \emph{ticks}}

#+BEGIN_SRC latex
  \begin{center}
    \includegraphics<1>[width=0.6\linewidth]{figures/mpl_ticks-1.pdf}
    \includegraphics<2>[width=0.6\linewidth]{figures/mpl_ticks0.pdf}
    \includegraphics<3>[width=0.6\linewidth]{figures/mpl_ticks1.pdf}
  \end{center}
#+END_SRC

#+BEAMER: \pause
#+ATTR_LATEX: :options fontsize=\scriptsize
#+BEGIN_SRC python
  In[11]: plt.xticks([0, np.pi/2, np.pi, 3*np.pi/2, 2*np.pi, 5*np.pi/2, 3*np.pi])
  In[12]: plt.yticks([-1, 0, +1])
#+END_SRC

#+BEAMER: \pause\vskip-18pt
#+ATTR_LATEX: :options fontsize=\scriptsize
#+BEGIN_SRC python
  In[13]: plt.xticks([0, np.pi/2, np.pi, 3*np.pi/2, 2*np.pi, 5*np.pi/2, 3*np.pi],
                     [r"$0$", r"$\pi/2$", r"$\pi$", r"$3\pi/2$", r"$2\pi", r"$5\pi/2$", r"$3\pi$"])
#+END_SRC

** /Kozmetix/ sous =matplotlib=
#+BEAMER: \framesubtitle{Axes : échelle, limites \& \emph{ticks}}

#+BEGIN_SRC latex
  \begin{center}
    \includegraphics<1>[width=0.6\linewidth]{figures/mpl_ticks1.pdf}
  \end{center}
#+END_SRC

#+ATTR_LATEX: :options fontsize=\scriptsize
#+BEGIN_SRC python
  In[11]: plt.xticks([0, np.pi/2, np.pi, 3*np.pi/2, 2*np.pi, 5*np.pi/2, 3*np.pi])
  In[12]: plt.yticks([-1, 0, +1])
#+END_SRC

#+BEAMER: \vskip-18pt
#+ATTR_LATEX: :options fontsize=\scriptsize
#+BEGIN_SRC python
  In[13]: plt.xticks([0, np.pi/2, np.pi, 3*np.pi/2, 2*np.pi, 5*np.pi/2, 3*np.pi],
                     [r"$0$", r"$\pi/2$", r"$\pi$", r"$3\pi/2$", r"$2\pi", r"$5\pi/2$", r"$3\pi$"])
#+END_SRC

#+ATTR_LATEX: :options [5][lbtuc][\centering][10][8]
#+BEGIN_CBOX
#+BEGIN_REMARK
Le prefixe =r= pour /raw-text/ indique que la chaîne de caractères doit être traiter
sans échapper les caractères précédés de =\=
#+END_REMARK
#+END_CBOX

** /Kozmetix/ sous =matplotlib=
#+BEAMER: \framesubtitle{Axes : échelles, limites \& \emph{ticks}}

*** Figure
:PROPERTIES:
:BEAMER_COL: 0.5
:END:

#+BEGIN_SRC latex
  \begin{center}
    \includegraphics<1>[width=1.1\linewidth]{figures/mpl_axis0.pdf}
    \includegraphics<2>[width=1.1\linewidth]{figures/mpl_axis1.pdf}
    \includegraphics<3>[width=1.1\linewidth]{figures/mpl_axis2.pdf}
    \includegraphics<4>[width=1.1\linewidth]{figures/mpl_axis3.pdf}
  \end{center}
#+END_SRC

*** Python code
:PROPERTIES:
:BEAMER_COL: 0.52
:END:

#+BEAMER: \small\vskip+17pt
- Accéder aux axes de la figure (=gca= \equiv =get current axis=)

#+ATTR_LATEX: :options fontsize=\scriptsize
#+BEGIN_SRC python
  In [4]: ax = plt.gca()
  In [5]: ax.grid()
#+END_SRC

#+BEAMER: \pause\vskip-18pt
#+ATTR_LATEX: :options fontsize=\scriptsize
#+BEGIN_SRC python
  In [6]: ax.spines["right"].set_color("none")
#+END_SRC

#+BEAMER: \pause\vskip-18pt
#+ATTR_LATEX: :options fontsize=\scriptsize
#+BEGIN_SRC python
  In [7]: ax.spines["top"].set_color("none")
#+END_SRC

#+BEAMER: \pause\vskip-18pt
#+ATTR_LATEX: :options fontsize=\scriptsize
#+BEGIN_SRC python
  In [8]: ax.spines["bottom"].set_position(("data",0))
#+END_SRC

** /Kozmetix/ sous =matplotlib=
#+BEAMER: \framesubtitle{Axes : échelles, limites \& \emph{ticks}}

*** Figure
:PROPERTIES:
:BEAMER_COL: 0.5
:END:

#+ATTR_LATEX: :width 1.1\linewidth
[[file:figures/mpl_twin_axis3.pdf]]

*** Python code
:PROPERTIES:
:BEAMER_COL: 0.52
:END:

#+BEAMER: \vskip+17pt

#+ATTR_LATEX: :options fontsize=\scriptsize
#+BEGIN_SRC python
  In [1]: r = np.linspace(0, 5, 100)
  In [2]: plt.plot(r, np.pi*r**2, color="C0")

  In [3]: ax = plt.gca()
  In [4]: for label in ax.get_yticklabels():
     ...:     label.set_color("C0")

  In [5]: plt.twinx()

  In [6]: plt.plot(r, 4/3*np.pi*r**3, color="C1")
  In [7]: ax = plt.gca()
  In [8]: for label in ax.get_yticklabels():
     ...:     label.set_color("C1")
#+END_SRC

** /Kozmetix/ sous =matplotlib=
#+BEAMER: \framesubtitle{\emph{Labelling} : titre, axes, légendes et autres annotations}

*** Figure
:PROPERTIES:
:BEAMER_COL: 0.5
:END:

#+BEGIN_SRC latex
  \begin{center}
    \includegraphics<1->[width=1.1\linewidth]{figures/mpl_title.pdf}
  \end{center}
#+END_SRC

*** Python code
:PROPERTIES:
:BEAMER_COL: 0.52
:END:

#+BEAMER: \vskip+17pt
#+ATTR_LATEX: :options fontsize=\scriptsize
#+BEGIN_SRC python
  In [4]: x = np.linspace(0, 3*np.pi, 100)
  In [5]: plt.plot(x, np.sin(x))

  In [6]: plt.title("Variation de la fonction sinus")
  In [7]: plt.xlabel(r"$\theta$")
  In [8]: plt.ylabel(r"$\sin\theta$")
#+END_SRC

** /Kozmetix/ sous =matplotlib=
#+BEAMER: \framesubtitle{\emph{Labelling} : titre, axes, légendes et autres annotations}
*** Figure
:PROPERTIES:
:BEAMER_COL: 0.5
:END:

#+BEGIN_SRC latex
  \begin{center}
    \includegraphics<1>[width=1.1\linewidth]{figures/mpl_legend0.pdf}
    \includegraphics<2>[width=1.1\linewidth]{figures/mpl_legend1.pdf}
    \includegraphics<3->[width=1.1\linewidth]{figures/mpl_legend2.pdf}
  \end{center}
#+END_SRC

*** Python code
:PROPERTIES:
:BEAMER_COL: 0.52
:END:

#+BEAMER: \small\vskip+17pt
#+ATTR_LATEX: :options fontsize=\scriptsize
#+BEGIN_SRC python
  In [4]: x = np.linspace(0, 3*np.pi, 100)
  In [5]: plt.plot(x, np.sin(x), label=r"$\sin\theta$")
  In [6]: plt.plot(x, np.cos(x), label=r"$\cos\theta$")
  In [7]: plt.axis("equal")

  In [8]: plt.legend()
#+END_SRC

#+BEAMER: \pause\vskip-18pt
#+ATTR_LATEX: :options fontsize=\scriptsize
#+BEGIN_SRC python
  In [9]: plt.legend(loc="upper left", frameon=False)
#+END_SRC

#+BEAMER: \pause\vskip-18pt
#+ATTR_LATEX: :options fontsize=\scriptsize
#+BEGIN_SRC python
  In[10]: plt.legend(loc="lower center", frameon=False,
                     ncol=2)
#+END_SRC

- Pour découvrir l'ensemble des options d'affichage *=plt.legend?=* ou
  *=help(plt.legend)=*

** /Kozmetix/ sous =matplotlib=
#+BEAMER: \framesubtitle{\emph{Labelling} : titre, axes, légendes et autres annotations}

#+BEGIN_SRC latex
  \begin{center}
    \includegraphics<1>[width=0.6\linewidth]{figures/mpl_text0.pdf}
    \includegraphics<2>[width=0.6\linewidth]{figures/mpl_text1.pdf}
  \end{center}
#+END_SRC

#+ATTR_LATEX: :options fontsize=\scriptsize
#+BEGIN_SRC python
  In[11]: plt.text(0, 3, "Matplotlib rocks !")
#+END_SRC

#+BEAMER: \pause\vskip-18pt
#+ATTR_LATEX: :options fontsize=\scriptsize
#+BEGIN_SRC python
  In[12]: plt.annotate(r"$\cos\left(\frac{\pi}{2}\right)=0$",
                       xy=(np.pi/2, np.cos(np.pi/2)), xytext=(3, 2),
                       arrowprops=dict(arrowstyle="->", connectionstyle="arc3,rad=.2"))
#+END_SRC

* Les modes de représentation
** Titre
:PROPERTIES:
:BEAMER_ENV: fullframe
:END:

#+BEGIN_EXPORT beamer
\title{Les modes de représentation}
\titlepage
\thispagestyle{empty}
#+END_EXPORT

** /Scatter plot/
*** Figure
:PROPERTIES:
:BEAMER_COL: 0.5
:END:

#+BEGIN_SRC latex
  \begin{center}
    \includegraphics<1>[width=1.1\linewidth]{figures/mpl_scatter0.pdf}
    \includegraphics<2>[width=1.1\linewidth]{figures/mpl_scatter1.pdf}
  \end{center}
#+END_SRC

*** Python code
:PROPERTIES:
:BEAMER_COL: 0.52
:END:

#+BEAMER: \vskip+17pt
#+ATTR_LATEX: :options fontsize=\scriptsize
#+BEGIN_SRC python
  In [1]: x = np.linspace(0, 3*np.pi, 30)
  In [2]: plt.scatter(x, np.sin(x), marker="o")
#+END_SRC

#+BEAMER: \pause\vskip-18pt
#+ATTR_LATEX: :options fontsize=\scriptsize
#+BEGIN_SRC python
  In [3]: plt.plot(x, np.cos(x), "o", color="orange")
#+END_SRC

** /Scatter plot/

- Le mode /scatter/ permet de contrôler (taille, couleur) chaque point/marqueur
  individuellement

*** Figure
:PROPERTIES:
:BEAMER_COL: 0.5
:END:

#+BEGIN_SRC latex
  \begin{center}
    \includegraphics<1>[width=1.1\linewidth]{figures/mpl_scatter2.pdf}
  \end{center}
#+END_SRC

*** Python code
:PROPERTIES:
:BEAMER_COL: 0.52
:END:

#+BEAMER: \vskip+17pt
#+ATTR_LATEX: :options fontsize=\scriptsize
#+BEGIN_SRC python
  In [1]: rng = np.random
  In [2]: x = rng.randn(100)
  In [3]: y = rng.randn(100)
  In [4]: colors = rng.rand(100)
  In [5]: sizes = 1000 * rng.rand(100)

  In [6]: plt.grid()
  In [7]: plt.scatter(x, y, c=colors, s=sizes, alpha=0.3,
                      cmap="viridis")
  In [8]: plt.colorbar()
#+END_SRC
** Barres d'erreur
*** Python code
:PROPERTIES:
:BEAMER_COL: 0.52
:END:

#+BEAMER: \vskip+17pt
#+ATTR_LATEX: :options fontsize=\scriptsize
#+BEGIN_SRC python
  In [1]: x = np.linspace(0, 10, 50)
  In [2]: dy = 0.8
  In [3]: y = np.sin(x) + dy * np.random.randn(50)

  In [4]: plt.errorbar(x, y, yerr=dy, fmt="o")
  In [5]: plt.plot(x, np.sin(x))
#+END_SRC

#+BEAMER: \pause\vskip-18pt
#+ATTR_LATEX: :options fontsize=\scriptsize
#+BEGIN_SRC python
  In [6]: plt.errorbar(x, y, yerr=dy,
                       fmt="o", color="black",
                       ecolor="lightgray",
                       elinewidth=3,
                       capsize=0)
#+END_SRC

#+BEAMER: \pause\vskip-18pt
#+ATTR_LATEX: :options fontsize=\scriptsize
#+BEGIN_SRC python
  In [7]: plt.fill_between(x, np.sin(x)-dy, np.sin(x)+dy,
                           alpha=0.2, color="gray")
#+END_SRC

*** Figure
:PROPERTIES:
:BEAMER_COL: 0.5
:END:

#+BEGIN_SRC latex
  \begin{center}
    \includegraphics<1>[width=1.1\linewidth]{figures/mpl_errorbar0.pdf}
    \includegraphics<2>[width=1.1\linewidth]{figures/mpl_errorbar1.pdf}
    \includegraphics<3>[width=1.1\linewidth]{figures/mpl_errorbar2.pdf}
  \end{center}
#+END_SRC

** Histogramme 1D
*** Python code
:PROPERTIES:
:BEAMER_COL: 0.52
:END:

#+BEAMER: \vskip+17pt
#+ATTR_LATEX: :options fontsize=\scriptsize
#+BEGIN_SRC python
  In [1]: data = np.random.randn(1000)
  In [2]: plt.hist(data)
#+END_SRC

#+BEAMER: \pause\vskip-18pt
#+ATTR_LATEX: :options fontsize=\scriptsize
#+BEGIN_SRC python
  In [3]: plt.hist(data, bins=30, normed=True)
#+END_SRC

*** Figure
:PROPERTIES:
:BEAMER_COL: 0.5
:END:

#+BEGIN_SRC latex
  \begin{center}
    \includegraphics<1>[width=1.1\linewidth]{figures/mpl_histogram0.pdf}
    \includegraphics<2>[width=1.1\linewidth]{figures/mpl_histogram1.pdf}
  \end{center}
#+END_SRC

** Histogramme 1D
*** Python code
:PROPERTIES:
:BEAMER_COL: 0.52
:END:

#+BEAMER: \vskip+17pt
#+ATTR_LATEX: :options fontsize=\scriptsize
#+BEGIN_SRC python
  In [0]: x1 = np.random.normal(0, 0.8, 1000)
  In [1]: x2 = np.random.normal(-2, 1, 1000)
  In [2]: x3 = np.random.normal(3, 2, 1000)

  In [3]: kwargs = dict(histtype="stepfilled", alpha=0.5,
                        normed=True, bins=40)

  In [4]: plt.hist(x1, **kwargs)
  In [5]: plt.hist(x2, **kwargs)
  In [6]: plt.hist(x3, **kwargs);
#+END_SRC

- Pour découvrir l'ensemble des options d'affichage *=plt.hist?=* ou *=help(plt.hist)=*

*** Figure
:PROPERTIES:
:BEAMER_COL: 0.5
:END:

#+BEGIN_SRC latex
  \begin{center}
    \includegraphics<1>[width=1.1\linewidth]{figures/mpl_histogram2.pdf}
  \end{center}
#+END_SRC
** COMMENT Histogramme 1D
*** Python code
:PROPERTIES:
:BEAMER_COL: 0.52
:END:

#+BEAMER: \vskip+17pt
#+ATTR_LATEX: :options fontsize=\scriptsize
#+BEGIN_SRC python
  In [1]: data = np.loadtxt("data/pv_2016_2017.tsv")

  In [2]: men_mask   = (data[:,-1] == 0)
  In [3]: women_mask = (data[:,-1] == 1)

  In [4]: men_means   = np.mean(data[men_mask], axis=0)
  In [5]: women_means = np.mean(data[women_mask], axis=0)

  In [6]: dx = 0.4
  In [7]: x = np.arange(5)
  In [8]: plt.bar(x-dx/2, men_means[:-1], dx)
  In [9]: plt.bar(x+dx/2, women_means[:-1], dx, color="pink")
  In[10]: plt.xticks(x,
          ["OPP", "Maths", "Méca. Ana.", "MQ1", "Anglais"])
#+END_SRC

*** Figure
:PROPERTIES:
:BEAMER_COL: 0.5
:END:

#+BEGIN_SRC latex
  \begin{center}
    \includegraphics<1>[width=1.1\linewidth]{figures/mpl_bar0.pdf}
  \end{center}
#+END_SRC
** COMMENT Histogramme 1D
*** Python code
:PROPERTIES:
:BEAMER_COL: 0.52
:END:

#+BEAMER: \vskip+17pt
#+ATTR_LATEX: :options fontsize=\scriptsize
#+BEGIN_SRC python
  In [1]: data = np.loadtxt("data/pv_2016_2017.tsv")

  In [2]: men_mask   = (data[:,-1] == 0)
  In [3]: women_mask = (data[:,-1] == 1)

  In [4]: men_means   = np.mean(data[men_mask], axis=0)
  In [5]: women_means = np.mean(data[women_mask], axis=0)

  In [6]: men_errs   = np.std(data[men_mask], axis=0) \
                      /np.sqrt(np.sum(men_mask))
  In [7]: women_errs = np.std(data[women_mask], axis=0) \
                      /np.sqrt(np.sum(women_mask))

  In [8]: dx = 0.4
  In [9]: x = np.arange(5)
  In[10]: plt.bar(x-dx/2, men_means[:-1], dx,
                  yerr=men_errs[:-1])
  In[11]: plt.bar(x+dx/2, women_means[:-1], dx, color="pink",
                  yerr=women_errs[:-1])
  In[12]: plt.xticks(x,
          ["OPP", "Maths", "Méca. Ana.", "MQ1", "Anglais"])
#+END_SRC

*** Figure
:PROPERTIES:
:BEAMER_COL: 0.5
:END:

#+BEGIN_SRC latex
  \begin{center}
    \includegraphics<1>[width=1.1\linewidth]{figures/mpl_bar0bis.pdf}
  \end{center}
#+END_SRC
** COMMENT Histogramme 1D
*** Python code
:PROPERTIES:
:BEAMER_COL: 0.52
:END:

#+BEAMER: \vskip+17pt
#+ATTR_LATEX: :options fontsize=\scriptsize
#+BEGIN_SRC python
  In [1]: data = np.loadtxt("data/pv_2016_2017.tsv")

  In [2]: men_mask   = (data[:,-1] == 0)
  In [3]: women_mask = (data[:,-1] == 1)

  In [4]: men_means   = np.mean(data[men_mask], axis=0)
  In [5]: women_means = np.mean(data[women_mask], axis=0)

  In [6]: dx = 0.4
  In [7]: x = np.arange(5)
  In [8]: plt.barh(x-dx/2, men_means[:-1], dx)
  In [9]: plt.barh(x+dx/2, women_means[:-1], dx, color="pink")
  In[10]: plt.yticks(x,
          ["OPP", "Maths", "Méca. Ana.", "MQ1", "Anglais"])
#+END_SRC

*** Figure
:PROPERTIES:
:BEAMER_COL: 0.5
:END:

#+BEGIN_SRC latex
  \begin{center}
    \includegraphics<1>[width=1.1\linewidth]{figures/mpl_bar1.pdf}
  \end{center}
#+END_SRC
** Histogramme 2D
*** Python code
:PROPERTIES:
:BEAMER_COL: 0.52
:END:

#+BEAMER: \vskip+17pt
#+ATTR_LATEX: :options fontsize=\scriptsize
#+BEGIN_SRC python
  In [1]: mean = [0, 0]
  In [2]: cov = [[1, 1], [1, 2]]
  In [3]: x, y = np.random.multivariate_normal(mean, cov, 10000).T

  In [4]: plt.hist2d(x, y, bins=30, cmap="Blues")
  In [5]: plt.colorbar()
#+END_SRC

*** Figure
:PROPERTIES:
:BEAMER_COL: 0.5
:END:

#+BEGIN_SRC latex
  \begin{center}
    \includegraphics<1>[width=1.1\linewidth]{figures/mpl_histogram3.pdf}
  \end{center}
#+END_SRC
** Contours & densités

#+BEGIN_SRC latex
  \begin{align*}
    z = f(x,y) =& \sin^{10} x + \cos(x\cdot y)\cdot\cos x\\
    =&\sin^{10}\begin{bmatrix}
    x_0&\cdots
    \end{bmatrix}+\cos\left(\begin{bmatrix}
        x_0&\cdots
      \end{bmatrix}\cdot\begin{bmatrix}
    y_0\\\vdots\end{bmatrix}\right)\cdot\cos\begin{bmatrix}
        x_0&\cdots
      \end{bmatrix}
  \end{align*}
#+END_SRC

#+BEAMER: \vskip-20pt
*** Python code
:PROPERTIES:
:BEAMER_COL: 0.55
:END:

#+ATTR_LATEX: :options fontsize=\scriptsize
#+BEGIN_SRC python
  In [1]: def f(x, y):
     ...:     return np.sin(x)**10 + np.cos(x*y) * np.cos(x)

  In [2]: x = np.linspace(0, 5, 500)
  In [3]: y = np.linspace(0, 5, 500)

  In [4]: X, Y = np.meshgrid(x, y)
  In [5]: Z = f(X, Y)

  In [6]: contours = plt.contour(X, Y, Z, 3, colors="black")
  In [7]: plt.clabel(contours, inline=True, fontsize=8)

  In [8]: plt.imshow(Z, extent=[0, 5, 0, 5], origin="lower",
                     cmap="RdGy", alpha=0.5)
  In [9]: plt.colorbar();
#+END_SRC

*** Color map
:PROPERTIES:
:BEAMER_COL: 0.55
:END:

#+BEAMER: \visible<2>{
#+ATTR_LATEX: :width 1.1\linewidth
[[file:figures/mpl_contour.pdf]]
#+BEAMER: }

** Image 2D
*** Python code
:PROPERTIES:
:BEAMER_COL: 0.55
:END:

#+ATTR_LATEX: :options fontsize=\scriptsize
#+BEGIN_SRC python
  In [1]: img = plt.imread("./data/puzo_patrick.png")
#+END_SRC

#+BEAMER: \vskip-18pt
#+ATTR_LATEX: :options fontsize=\scriptsize
#+BEGIN_SRC python
  In [2]: plt.imshow(img)
  In [3]: plt.title("P. Puzo après le partiel d'EM")
#+END_SRC

#+BEAMER: \pause\vskip-18pt
#+ATTR_LATEX: :options fontsize=\scriptsize
#+BEGIN_SRC python
  In [4]: plt.scatter(725, 1000, c="red", s=1000)
  In [5]: plt.title("P. Puzo après son anniversaire")
#+END_SRC

*** Color map
:PROPERTIES:
:BEAMER_COL: 0.55
:END:

#+BEGIN_SRC latex
  \begin{center}
    \includegraphics<1>[width=1.1\linewidth]{figures/puzo_patrick0.pdf}
    \includegraphics<2>[width=1.1\linewidth]{figures/puzo_patrick1.pdf}
  \end{center}
#+END_SRC
** COMMENT Figure 3D
*** Python code
:PROPERTIES:
:BEAMER_COL: 0.52
:END:

#+ATTR_BEAMER: :overlay +-
- La représentation 3D suppose le chargement de l'outil *=mplot3d=* inclus par
  défaut dans =matplotlib=
  #+BEGIN_SRC python
    In [1]: from mpl_toolkits import mplot3d
  #+END_SRC

- Une vue 3D est initialisée en spécifiant le type de projection
  #+BEGIN_SRC python
    In [2]: ax = plt.axes(projection="3d")
  #+END_SRC

*** Figure
:PROPERTIES:
:BEAMER_COL: 0.5
:END:

#+BEGIN_SRC latex
  \begin{center}
    \includegraphics<2>[width=1.1\linewidth]{figures/mpl_3d0.pdf}
  \end{center}
#+END_SRC


#+BEGIN_COMMENT
http://nbviewer.jupyter.org/github/jakevdp/PythonDataScienceHandbook/blob/master/notebooks/04.12-Three-Dimensional-Plotting.ipynb

http://nbviewer.jupyter.org/github/jrjohansson/scientific-python-lectures/blob/master/Lecture-4-Matplotlib.ipynb#Coutour-plots-with-projections
#+END_COMMENT
** COMMENT Figure 3D
#+BEAMER: \framesubtitle{\texttt{plot3D} \& \texttt{scatter3D}}

*** Python code
:PROPERTIES:
:BEAMER_COL: 0.52
:END:

#+BEAMER: \vskip+17pt
#+ATTR_LATEX: :options fontsize=\scriptsize
#+BEGIN_SRC python
  In [2]: ax = plt.axes(projection="3d")

  In [3]: # Data for a three-dimensional line
  In [4]: zline = np.linspace(0, 15, 1000)
  In [5]: xline = np.sin(zline)
  In [6]: yline = np.cos(zline)
  In [7]: ax.plot3D(xline, yline, zline, "gray")
#+END_SRC

#+BEAMER: \pause\vskip-18pt
#+ATTR_LATEX: :options fontsize=\scriptsize
#+BEGIN_SRC python
  In [8]: # Data for three-dimensional scattered points
  In [9]: zdata = 15 * np.random.random(100)
  In[10]: xdata = np.sin(zdata) + 0.1*np.random.randn(100)
  In[11]: ydata = np.cos(zdata) + 0.1*np.random.randn(100)
  In[12]: ax.scatter3D(xdata, ydata, zdata, c=zdata)
#+END_SRC

*** Figure
:PROPERTIES:
:BEAMER_COL: 0.5
:END:

#+BEGIN_SRC latex
  \begin{center}
    \includegraphics<1>[width=1.1\linewidth]{figures/mpl_3d1.pdf}
    \includegraphics<2>[width=1.1\linewidth]{figures/mpl_3d2.pdf}
  \end{center}
#+END_SRC


#+BEGIN_COMMENT
http://nbviewer.jupyter.org/github/jakevdp/PythonDataScienceHandbook/blob/master/notebooks/04.12-Three-Dimensional-Plotting.ipynb

http://nbviewer.jupyter.org/github/jrjohansson/scientific-python-lectures/blob/master/Lecture-4-Matplotlib.ipynb#Coutour-plots-with-projections
#+END_COMMENT
** COMMENT Figure 3D
#+BEAMER: \framesubtitle{\texttt{plot\_wireframe} \& \texttt{plot\_surface}}

*** Python code
:PROPERTIES:
:BEAMER_COL: 0.52
:END:

- $f(x,y) = \sin(\sqrt{x^2+y^2})$
  #+BEAMER: \vskip5pt
  #+ATTR_LATEX: :options fontsize=\scriptsize
  #+BEGIN_SRC python
    In [2]: ax = plt.axes(projection="3d")
    In [3]: def f(x, y):
       ...:     return np.sin(np.sqrt(x**2 + y**2))

    In [4]: x = np.linspace(-6, 6, 30)
    In [5]: y = np.linspace(-6, 6, 30)

    In [6]: X, Y = np.meshgrid(x, y)
    In [7]: Z = f(X, Y)
  #+END_SRC

  #+BEAMER: \pause\vskip-18pt
  #+ATTR_LATEX: :options fontsize=\scriptsize
  #+BEGIN_SRC python
    In [8]: ax.plot_wireframe(X, Y, Z, linewidth=0.5
                              color="gray")
  #+END_SRC

  #+BEAMER: \pause\vskip-18pt
  #+ATTR_LATEX: :options fontsize=\scriptsize
  #+BEGIN_SRC python
    In [9]: ax.plot_surface(X, Y, Z, cmap="viridis")
  #+END_SRC

*** Figure
:PROPERTIES:
:BEAMER_COL: 0.5
:END:

#+BEGIN_SRC latex
  \begin{center}
    \includegraphics<2>[width=1.1\linewidth]{figures/mpl_3dwireframe.pdf}
    \includegraphics<3>[width=1.1\linewidth]{figures/mpl_3dsurface.pdf}
  \end{center}
#+END_SRC
** COMMENT Figure 3D
#+BEAMER: \framesubtitle{\texttt{plot\_wireframe} \& \texttt{plot\_surface}}

*** Python code
:PROPERTIES:
:BEAMER_COL: 0.52
:END:

- $f(x,y) = \sin(\sqrt{x^2+y^2})$
  #+BEAMER: \vskip5pt
  #+ATTR_LATEX: :options fontsize=\scriptsize
  #+BEGIN_SRC python
    In [2]: ax = plt.axes(projection="3d")
    In [3]: def f(x, y):
       ...:     return np.sin(np.sqrt(x**2 + y**2))

    In [4]: x = np.linspace(-6, 6, 30)
    In [5]: y = np.linspace(-6, 6, 30)

    In [6]: X, Y = np.meshgrid(x, y)
    In [7]: Z = f(X, Y)
    In [9]: ax.plot_surface(X, Y, Z, alpha=0.25,
                            edgecolor="k", linewidth=0.1)

  #+END_SRC
  #+BEAMER: \pause\vskip-18pt
  #+ATTR_LATEX: :options fontsize=\scriptsize
  #+BEGIN_SRC python
    In[10]: ax.contour(X, Y, Z, zdir="z", offset=+1)
    In[11]: ax.contour(X, Y, Z, zdir="y", offset=-7)
    In[12]: ax.contour(X, Y, Z, zdir="x", offset=+7)
    In[13]: ax.set_zlim3d(-1, 1)
    In[14]: ax.set_ylim3d(-7, 7)
    In[15]: ax.set_xlim3d(-7, 7)
  #+END_SRC

*** Figure
:PROPERTIES:
:BEAMER_COL: 0.5
:END:

#+BEGIN_SRC latex
  \begin{center}
    \includegraphics<1>[width=1.1\linewidth]{figures/mpl_3dcontour0.pdf}
    \includegraphics<2>[width=1.1\linewidth]{figures/mpl_3dcontour1.pdf}
  \end{center}
#+END_SRC
** Autres modes de représentation
#+BEAMER: \framesubtitle{\emph{Polar \& Pie charts}}
*** Figure
:PROPERTIES:
:BEAMER_COL: 0.5
:END:

#+BEGIN_SRC latex
  \begin{center}
    \includegraphics<1>[width=1.1\linewidth]{figures/mpl_polar0.pdf}
    \includegraphics<2>[width=1.1\linewidth]{figures/mpl_polar1.pdf}
  \end{center}
#+END_SRC
*** Python code
:PROPERTIES:
:BEAMER_COL: 0.52
:END:

#+ATTR_LATEX: :options fontsize=\scriptsize
#+BEGIN_SRC python
  In [2]: ax = plt.axes(projection="polar")
#+END_SRC
#+BEAMER: \pause\vskip-30pt
#+ATTR_LATEX: :options fontsize=\scriptsize
#+BEGIN_SRC python
  In [3]: r = np.arange(0, 2, 0.01)
  In [4]: theta = 2 * np.pi * r

  In [5]: ax.plot(theta, r)
  In [6]: ax.set_rmax(2)
  In [7]: ax.set_rticks([0.5, 1, 1.5, 2])
#+END_SRC
** COMMENT Autres modes de représentation
#+BEAMER: \framesubtitle{\emph{Polar \& Pie charts}}
*** Figure
:PROPERTIES:
:BEAMER_COL: 0.5
:END:

#+BEGIN_SRC latex
  \begin{center}
    \includegraphics<1>[width=1.1\linewidth]{figures/mpl_polar3.pdf}
  \end{center}
#+END_SRC
*** Python code
:PROPERTIES:
:BEAMER_COL: 0.52
:END:

#+ATTR_LATEX: :options fontsize=\scriptsize
#+BEGIN_SRC python
    In [2]: ax = plt.axes(projection="polar")
    In [3]: N = 150
    In [4]: r = 2 * np.random.rand(N)
    In [5]: theta = 2 * np.pi * np.random.rand(N)
    In [6]: area = 200 * r**2

    In [7]: ax.scatter(theta, r, c=theta, s=area, alpha=0.75)
#+END_SRC
** COMMENT Autres modes de représentation
#+BEAMER: \framesubtitle{\emph{Polar \& Pie charts}}
*** Figure
:PROPERTIES:
:BEAMER_COL: 0.5
:END:

#+BEGIN_SRC latex
  \begin{center}
    \includegraphics<1>[width=1.1\linewidth]{figures/mpl_polar2.pdf}
  \end{center}
#+END_SRC
*** Python code
:PROPERTIES:
:BEAMER_COL: 0.52
:END:

#+ATTR_LATEX: :options fontsize=\scriptsize
#+BEGIN_SRC python
  In [2]: ax = plt.axes(projection="polar")
  In [3]: N = 20
  In [4]: theta = np.linspace(0.0, 2 * np.pi, N)
  In [5]: radii = 10 * np.random.rand(N)
  In [6]: width = np.pi / 4 * np.random.rand(N)

  In [7]: bars = ax.bar(theta, radii, width=width)

  In [8]: for r, bar in zip(radii, bars):
     ...:     bar.set_facecolor(plt.cm.viridis(r/10))
     ...:     bar.set_alpha(0.5)
#+END_SRC
** Autres modes de représentation
#+BEAMER: \framesubtitle{\emph{Polar \& Pie charts}}
*** Figure
:PROPERTIES:
:BEAMER_COL: 0.5
:END:

#+BEGIN_SRC latex
  \begin{center}
    \includegraphics<1>[width=1.1\linewidth]{figures/mpl_pie.pdf}
  \end{center}
#+END_SRC
*** Python code
:PROPERTIES:
:BEAMER_COL: 0.6
:END:

#+ATTR_LATEX: :options fontsize=\scriptsize
#+BEGIN_SRC python
  In [2]: labels = "Méthodes num.", "Phys. Maths", \
                   "Chimie Orga. 1", "Vulga.",     \
                   "Hist. des Sciences", "Théorie des groupes"
  In [3]: percent = np.array([4.2, 28.1, 24.0, 19.8, 10.4, 44.8])

  In [4]: plt.pie(percent, labels=labels, autopct="%1.1f%%",
                  colors=plt.cm.Pastel1(percent/100))
  In [5]: plt.axis("equal")
#+END_SRC

#+BEGIN_COMMENT
Création d'un donut
https://medium.com/@krishnakummar/donut-chart-with-python-matplotlib-d411033c960b#.kilzpdf8y
#+END_COMMENT

** /Subplot/

- =matplotlib= permet une gestion relativement aisée du placement des figures et
  de leurs sous-figures

*** Python code
:PROPERTIES:
:BEAMER_COL: 0.52
:END:

#+BEAMER: \small
#+ATTR_LATEX: :options fontsize=\scriptsize
#+BEGIN_SRC python
  In [2]: ax1 = plt.axes()
#+END_SRC
#+BEAMER: \pause\vskip-25pt
#+ATTR_LATEX: :options fontsize=\scriptsize
#+BEGIN_SRC python
  In [3]: ax2 = plt.axes([0.65, 0.65, 0.2, 0.2])
#+END_SRC

#+BEAMER: \small
avec =axes([x, y, w, h])= et *=x,y,w,h= exprimés en fraction du canevas initial*

*** Figure
:PROPERTIES:
:BEAMER_COL: 0.5
:END:

#+BEGIN_SRC latex
  \begin{center}
    \includegraphics<1>[width=1.1\linewidth]{figures/mpl_subplot0.pdf}
    \includegraphics<2>[width=1.1\linewidth]{figures/mpl_subplot1.pdf}
  \end{center}
#+END_SRC
** /Subplot/

- =matplotlib= permet une gestion relativement aisée du placement des figures et
  de leurs sous-figures

*** Python code
:PROPERTIES:
:BEAMER_COL: 0.52
:END:

#+BEAMER: \vskip+17pt
#+ATTR_LATEX: :options fontsize=\scriptsize
#+BEGIN_SRC python
  In [2]: x = np.linspace(-1, 1, 1000)
  In [3]: plt.plot(x, x**2, x, x**3)

  In [4]: inset = plt.axes([0.6, 0.2, 0.25, 0.25])

  In [5]: inset.plot(x, x**2, x, x**3)
  In [6]: inset.set_title("zoom x = 0")
  In [7]: inset.set_xlim(-0.2, +0.2)
  In [8]: inset.set_ylim(-0.005, +0.01)
#+END_SRC

*** Figure
:PROPERTIES:
:BEAMER_COL: 0.5
:END:

#+BEGIN_SRC latex
  \begin{center}
    \includegraphics<1>[width=1.1\linewidth]{figures/mpl_subplot2.pdf}
  \end{center}
#+END_SRC
** /Subplot/

- La commande *=subplot=* permet la génération *sous-figure par sous-figure* selon
  une représentation matricielle

*** Python code
:PROPERTIES:
:BEAMER_COL: 0.52
:END:

#+ATTR_LATEX: :options fontsize=\scriptsize
#+BEGIN_SRC python
  In [2]: plt.subplot(2, 3, 1)
#+END_SRC
#+BEAMER: \pause\vskip-30pt
#+ATTR_LATEX: :options fontsize=\scriptsize
#+BEGIN_SRC python
  In [3]: plt.subplot(2, 3, 3)
#+END_SRC
#+BEAMER: \pause\vskip-30pt
#+ATTR_LATEX: :options fontsize=\scriptsize
#+BEGIN_SRC python
  In [4]: plt.subplot(2, 3, 5)
#+END_SRC

*** Figure
:PROPERTIES:
:BEAMER_COL: 0.5
:END:

#+BEGIN_SRC latex
  \begin{center}
    \includegraphics<1>[width=1.1\linewidth]{figures/mpl_subplot3.pdf}
    \includegraphics<2>[width=1.1\linewidth]{figures/mpl_subplot4.pdf}
    \includegraphics<3>[width=1.1\linewidth]{figures/mpl_subplot5.pdf}
  \end{center}
#+END_SRC
** /Subplot/

- La commande *=subplots=* permet la génération de *l'ensemble des sous-figures*
  selon une représentation matricielle

*** Python code
:PROPERTIES:
:BEAMER_COL: 0.52
:END:

#+ATTR_LATEX: :options fontsize=\scriptsize
#+BEGIN_SRC python
  In [1]: fig, ax = plt.subplots(2, 3, sharex=True, sharey=True)
#+END_SRC
#+BEAMER: \pause\vskip-30pt
#+ATTR_LATEX: :options fontsize=\scriptsize
#+BEGIN_SRC python
  In [2]: for i in range(2):
     ...:     for j in range(3):
     ...:         ax[i, j].text(0.5, 0.5, str((i, j)),
     ...:                       fontsize=18, ha="center")
#+END_SRC
#+BEAMER: \pause\vskip-30pt
#+ATTR_LATEX: :options fontsize=\scriptsize
#+BEGIN_SRC python
  In [3]: plt.subplots_adjust(hspace=0, wspace=0)
#+END_SRC

*** Figure
:PROPERTIES:
:BEAMER_COL: 0.5
:END:

#+BEGIN_SRC latex
  \begin{center}
    %% \includegraphics<1>[width=1.1\linewidth]{figures/mpl_subplot6.pdf}
    %% \includegraphics<2>[width=1.1\linewidth]{figures/mpl_subplot7.pdf}
    \includegraphics<1>[width=1.1\linewidth]{figures/mpl_subplot8.pdf}
    \includegraphics<2>[width=1.1\linewidth]{figures/mpl_subplot9.pdf}
    \includegraphics<3>[width=1.1\linewidth]{figures/mpl_subplot_hspace.pdf}
  \end{center}
#+END_SRC

** /Subplot/

- La commande *=GridSpec=* ne génère pas de figures ou sous figures mais facilite
  la gestion et notamment la fusion d'espaces réservés aux sous-figures

*** Python code
:PROPERTIES:
:BEAMER_COL: 0.55
:END:

#+ATTR_LATEX: :options fontsize=\scriptsize
#+BEGIN_SRC python
  In [2]: grid = plt.GridSpec(2, 3, hspace=0.4, wspace=0.4)
#+END_SRC
#+BEAMER: \pause\vskip-30pt
#+ATTR_LATEX: :options fontsize=\scriptsize
#+BEGIN_SRC python
  In [3]: plt.subplot(grid[0, 0])
#+END_SRC
#+BEAMER: \pause\vskip-30pt
#+ATTR_LATEX: :options fontsize=\scriptsize
#+BEGIN_SRC python
  In [4]: plt.subplot(grid[0, 1:])
#+END_SRC
#+BEAMER: \pause\vskip-30pt
#+ATTR_LATEX: :options fontsize=\scriptsize
#+BEGIN_SRC python
  In [5]: plt.subplot(grid[1, :2])
#+END_SRC
#+BEAMER: \pause\vskip-30pt
#+ATTR_LATEX: :options fontsize=\scriptsize
#+BEGIN_SRC python
  In [6]: plt.subplot(grid[1, 2])
#+END_SRC

*** Figure
:PROPERTIES:
:BEAMER_COL: 0.5
:END:

#+BEGIN_SRC latex
  \begin{center}
    \includegraphics<2>[width=1.1\linewidth]{figures/mpl_subplot10.pdf}
    \includegraphics<3>[width=1.1\linewidth]{figures/mpl_subplot11.pdf}
    \includegraphics<4>[width=1.1\linewidth]{figures/mpl_subplot12.pdf}
    \includegraphics<5>[width=1.1\linewidth]{figures/mpl_subplot13.pdf}
  \end{center}
#+END_SRC

** /Subplot/
*** Python code
:PROPERTIES:
:BEAMER_COL: 0.55
:END:

#+ATTR_LATEX: :options fontsize=\scriptsize
#+BEGIN_SRC python
  import numpy as np
  import matplotlib.pyplot as plt

  x = np.linspace(0, 10, 100)
  dy = 0.4
  y = np.sin(x) + dy * np.random.randn(100)

  grid = plt.GridSpec(4, 1, hspace=0, wspace=0)

  main = plt.subplot(grid[0:3], xticklabels=[], xlim=[0, 10])
  main.plot(x, np.sin(x), "r")
  main.errorbar(x, y, yerr=dy, fmt="ok")
  main.set_ylabel(r"$y$")

  dev = plt.subplot(grid[3], xlim=[0, 10])
  dev.errorbar(x, y - np.sin(x), yerr=dy, fmt="ok")
  dev.plot([0, 10], [0, 0], "--r")
  dev.set_ylabel(r"$y-y_\mathrm{model}$")
  dev.set_xlabel(r"$\theta$")

  plt.show()
#+END_SRC

*** Figure
:PROPERTIES:
:BEAMER_COL: 0.5
:END:

#+BEGIN_SRC latex
  \begin{center}
    \includegraphics<2>[width=1.1\linewidth]{figures/mpl_subplot15.pdf}
  \end{center}
#+END_SRC

** /Subplot/
*** Python code
:PROPERTIES:
:BEAMER_COL: 0.55
:END:

#+ATTR_LATEX: :options fontsize=\scriptsize
#+BEGIN_SRC python
  import numpy as np
  import matplotlib.pyplot as plt

  # Create some normally distributed data
  mean = [0, 0]
  cov = [[1, 1], [1, 2]]
  x, y = np.random.multivariate_normal(mean, cov, 3000).T

  # Set up the axes with gridspec
  plt.figure(figsize=(6, 6))
  grid = plt.GridSpec(4, 4, hspace=0, wspace=0)
  main_ax = plt.subplot(grid[:-1, 1:], xticklabels=[],
                        yticklabels=[])
  y_hist = plt.subplot(grid[:-1, 0], xticklabels=[])
  x_hist = plt.subplot(grid[-1, 1:], yticklabels=[])

  # scatter points on the main axes
  main_ax.plot(x, y, "ok", markersize=3, alpha=0.2)

  # histogram on the attached axes
  x_hist.hist(x, 40, histtype="stepfilled",
              orientation="vertical", color="gray")
  x_hist.invert_yaxis()

  y_hist.hist(y, 40, histtype="stepfilled",
              orientation="horizontal", color="gray")
  y_hist.invert_xaxis()

  plt.show()
#+END_SRC

*** Figure
:PROPERTIES:
:BEAMER_COL: 0.5
:END:

#+BEGIN_SRC latex
  \begin{center}
    \includegraphics<2>[width=1.1\linewidth]{figures/mpl_subplot14.pdf}
  \end{center}
#+END_SRC

* COMMENT =matplotlib= et plus si affinités
** Titre
:PROPERTIES:
:BEAMER_ENV: fullframe
:END:

#+BEGIN_EXPORT beamer
\title{Épilogue : \texttt{matplotlib} et plus si affinités}
\titlepage
#+END_EXPORT

** =matplotlib= et la programmation orientée objet

- Historiquement, =matplotlib= a été développée comme un clone de =MATLAB= afin de
  faciliter la conversion des utilisateurs de =MATLAB=

- L'interface =pyplot= (=plt=) fournit ainsi des commandes identiques à celles de
  =MATLAB=

#+BEAMER: \vspace{-0.5cm}

*** Python code
:PROPERTIES:
:BEAMER_COL: 0.55
:END:

#+ATTR_LATEX: :options fontsize=\scriptsize
#+BEGIN_SRC python
  In [1]: import numpy as np
  In [2]: x = np.linspace(0, 10, 100)

  In [3]: import matplotlib.pyplot as plt
  In [4]: plt.figure()

  In [5]: plt.subplot(2, 1, 1)
  In [6]: plt.plot(x, np.sin(x))

  In [7]: plt.subplot(2, 1, 2)
  In [8]: plt.plot(x, np.cos(x))
#+END_SRC

#+BEAMER: \pause
#+BEGIN_REMARK
Comment accéder à la première sous-figure une fois la seconde affichée ?
#+END_REMARK

*** Figure
:PROPERTIES:
:BEAMER_COL: 0.5
:END:

#+BEGIN_SRC latex
  \begin{center}
    \includegraphics<1->[width=1.1\linewidth]{figures/mpl_poo0.pdf}
  \end{center}
#+END_SRC

** =matplotlib= et la programmation orientée objet

- L'interface "orientée objet" fournit un accès simple aux différents éléments
  d'une figure

#+BEAMER: \vspace{-0.5cm}

*** Python code
:PROPERTIES:
:BEAMER_COL: 0.55
:END:

#+ATTR_LATEX: :options fontsize=\scriptsize
#+BEGIN_SRC python
  In [1]: import numpy as np
  In [2]: x = np.linspace(0, 10, 100)

  In [3]: import matplotlib.pyplot as plt
  In [4]: fig, ax = plt.subplots(2)

  In [5]: ax[0].plot(x, np.sin(x))
  In [6]: ax[1].plot(x, np.cos(x))
#+END_SRC

*** Figure
:PROPERTIES:
:BEAMER_COL: 0.5
:END:

#+BEGIN_SRC latex
  \begin{center}
    \includegraphics<1->[width=1.1\linewidth]{figures/mpl_poo0.pdf}
  \end{center}
#+END_SRC
** =matplotlib= et la programmation orientée objet

- L'interface "orientée objet" fournit un accès simple aux différents éléments
  d'une figure

#+BEAMER: \pause

- Certaines fonctions de l'interface =pyplot= sont toutefois légèrement
  différentes

  - =plt.xlabel()= \to =ax.set_xlabel()=
  - =plt.ylabel()= \to =ax.set_ylabel()=
  - =plt.xlim()= \to =ax.set_xlim()=
  - =plt.ylim()= \to =ax.set_ylim()=
  - =plt.title()= \to =ax.set_title()=

#+BEAMER: \pause

- L'avantage avec l'interface =Axes= réside dans la possibilité d'assigner un
  certain nombre de champ /via/ la méthode =set=

  #+ATTR_LATEX: :options fontsize=\scriptsize
  #+BEGIN_SRC python
    In [3]: ax = plt.axes()
    In [4]: ax.plot(x, np.sin(x))
    In [5]: ax.set(xlim=(0, 10), ylim=(-2, 2),
                   xlabel="x", ylabel="sin(x)",
                   title="A Simple Plot");
  #+END_SRC
